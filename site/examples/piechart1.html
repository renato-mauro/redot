<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>piechart1</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link href="../css/bootstrap.min.css" rel="stylesheet">
  <style type="text/css">
  td.lineNumbers {width:60px;}
  </style>
  <style id="theStyle">
  text {
      font-family: sans-serif;
      font-size: 10pt;
      text-anchor: middle;     
      dominant-baseline: middle;             
  }
  
  text.title {
      font-size: 20pt;
  }
  
  text.legend {
      text-anchor: start;
  }
  </style>
</head>
<body>

		<nav class="navbar navbar-default">
		  <div class="container-fluid">
		    <div class="navbar-header">
		      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
		        <span class="sr-only">Toggle navigation</span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		      </button>
		      <a class="navbar-brand" href="http://renato-mauro.github.io/redot/">REDOT</a>
		    </div>
		    <div id="navbar" class="navbar-collapse collapse">
		      <ul class="nav navbar-nav">
		        <li><a href="https://github.com/renato-mauro/redot">Github</a></li>
		        <li><a href="#">Tutorial</a></li>
		        <li><a href="https://github.com/renato-mauro/redot/archive/master.zip">Download</a></li>
		        <li class="dropdown">
		          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Examples <span class="caret"></span></a>
		          <ul class="dropdown-menu">
	
<li><a href="http://renato-mauro.github.io/redot/site/examples/barchart1.html">Bar chart</a></li>
<li><a href="http://renato-mauro.github.io/redot/site/examples/d3force1.html">D3 layouts</a></li>
<li><a href="http://renato-mauro.github.io/redot/site/examples/filter.html">Array filtering</a></li>
<li><a href="http://renato-mauro.github.io/redot/site/examples/piechart1.html">Pie chart</a></li>
<li><a href="http://renato-mauro.github.io/redot/site/examples/piegrid1.html">Pie chart grid</a></li>
<li><a href="http://renato-mauro.github.io/redot/site/examples/squares.html">Squares Example</a></li>

		          </ul>
		        </li>
		      </ul>
		    </div><!--/.nav-collapse -->
		  </div><!--/.container-fluid -->
		</nav>
<div class="container">
<h1 id="pie-chart">Pie chart</h1>
<p>Pie chart showing web browser usage statistics. Demonstration of the <code>stack</code> reactive operator.</p>
<button onclick="jsfiddle('Pie chart','Pie chart showing web browser usage statistics. Demonstration of the &lt;code&gt;">
stack</code> reactive operator.','')&quot;&gt;Open in JSFiddle
</button>
<div id="main" style="margin:10px 0;">

</div>
<h2 id="css-piechart1.css">CSS (piechart1.css)</h2>
<div class="sourceCode"><table class="sourceCode css numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="sourceCode"><pre><code class="sourceCode css">text <span class="kw">{</span>
    <span class="kw">font-family:</span> <span class="dt">sans-serif</span><span class="kw">;</span>
    <span class="kw">font-size:</span> <span class="dt">10pt</span><span class="kw">;</span>
    <span class="kw">text-anchor:</span> <span class="dt">middle</span><span class="kw">;</span>     
    <span class="kw">dominant-baseline:</span> <span class="dt">middle</span><span class="kw">;</span>             
<span class="kw">}</span>

text<span class="fl">.title</span> <span class="kw">{</span>
    <span class="kw">font-size:</span> <span class="dt">20pt</span><span class="kw">;</span>
<span class="kw">}</span>

text<span class="fl">.legend</span> <span class="kw">{</span>
    <span class="kw">text-anchor:</span> start<span class="kw">;</span>
<span class="kw">}</span></code></pre></td></tr></table></div>
<h2 id="javascript">Javascript</h2>
<div class="sourceCode"><table class="sourceCode javascript numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre></td><td class="sourceCode"><pre><code class="sourceCode javascript"><span class="kw">var</span> data <span class="op">=</span>     
<span class="op">{</span>
    <span class="st">&quot;date&quot;</span><span class="op">:</span> <span class="st">&quot;April 2016&quot;</span><span class="op">,</span>
    <span class="st">&quot;elements&quot;</span><span class="op">:</span> [
        <span class="op">{</span> <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;Internet Explorer&quot;</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fl">0.096</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&quot;#D95B43&quot;</span> <span class="op">},</span>
        <span class="op">{</span> <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;Firefox&quot;</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fl">0.097</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&quot;#C02942&quot;</span>  <span class="op">},</span>
        <span class="op">{</span> <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;Google Chrome&quot;</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fl">0.572</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&quot;#ECD078&quot;</span> <span class="op">},</span>
        <span class="op">{</span> <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;Safari&quot;</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fl">0.134</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&quot;#53777A&quot;</span> <span class="op">},</span>
        <span class="op">{</span> <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;Opera&quot;</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fl">0.041</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&quot;#542437&quot;</span> <span class="op">},</span>
        <span class="op">{</span> <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;Other&quot;</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fl">0.06</span><span class="op">,</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&quot;#535353&quot;</span> <span class="op">}</span>
    ]
<span class="op">};</span>

<span class="co">// PieChart Template</span>
<span class="kw">function</span> <span class="at">PieChart</span>()
<span class="op">{</span>
    <span class="kw">this</span>.<span class="at">width</span>    <span class="op">=</span> <span class="dv">400</span><span class="op">;</span> <span class="co">// define width of client area</span>
    <span class="kw">this</span>.<span class="at">height</span>   <span class="op">=</span> <span class="dv">400</span><span class="op">;</span> <span class="co">// define height of client area</span>
    <span class="kw">this</span>.<span class="at">radius</span>   <span class="op">=</span> <span class="st">&quot;{width*0.30}&quot;</span><span class="op">;</span>
    <span class="kw">this</span>.<span class="at">count</span>    <span class="op">=</span> <span class="st">&quot;{d.elements.length}&quot;</span><span class="op">;</span>

    <span class="co">/**********************************************************************************</span>
<span class="co">    &lt;div&gt;</span>
<span class="co">        &lt;svg width=&quot;{width}&quot; height=&quot;{height}&quot; style=&quot;border: 1px black solid;&quot;&gt;</span>
<span class="co">            &lt;text class=&quot;title&quot; style=&quot;&quot; x=&quot;{width/2}&quot; y=&quot;40&quot;&gt;</span>
<span class="co">                {d.date}</span>
<span class="co">            &lt;/text&gt;</span>
<span class="co">            &lt;g transform=&quot;translate({width/2} {height/2})&quot;&gt;</span>
<span class="co">                &lt;include template=&quot;{PieSlice}&quot; data=&quot;{d.elements}&quot; /&gt;</span>
<span class="co">            &lt;/g&gt;</span>
<span class="co">            &lt;g transform=&quot;translate(0 {height-16*count})&quot;&gt;</span>
<span class="co">                &lt;include template=&quot;{Legend}&quot; data=&quot;{d.elements}&quot; /&gt;</span>
<span class="co">            &lt;/g&gt;</span>
<span class="co">        &lt;/svg&gt;</span>
<span class="co">    &lt;/div&gt;</span>
<span class="co">    ********************************************************************************/</span>
<span class="op">}</span>

<span class="co">// PieSlice Template</span>
<span class="kw">function</span> <span class="at">PieSlice</span>()
<span class="op">{</span>
    <span class="kw">this</span>.<span class="at">pieRange</span> <span class="op">=</span> <span class="va">redot</span>.<span class="at">stack</span>(<span class="st">&quot;{d.value}&quot;</span>)<span class="op">;</span>

    <span class="co">/***********************************************************************************</span>
<span class="co">    &lt;path d=&quot;{redot.path.pieSlice(parent.radius,pieRange)}&quot; stroke=&quot;black&quot; fill=&quot;{d.color}&quot;/&gt;</span>
<span class="co">    &lt;text class=&quot;pietext&quot; transform=&quot;{redot.centroid.pieSlice(parent.radius,pieRange)}&quot;&gt;</span>
<span class="co">        {redot.format.percent(d.value)}</span>
<span class="co">    &lt;/text&gt;</span>
<span class="co">    ***********************************************************************************/</span>
<span class="op">}</span>

<span class="co">// Legend Template</span>
<span class="kw">function</span> <span class="at">Legend</span>()
<span class="op">{</span>
    <span class="kw">this</span>.<span class="at">x</span> <span class="op">=</span> <span class="dv">5</span><span class="op">;</span>
    <span class="kw">this</span>.<span class="at">y</span> <span class="op">=</span> <span class="st">&quot;{i*16-5}&quot;</span><span class="op">;</span>

    <span class="co">/***********************************************************************************</span>
<span class="co">    &lt;g transform=&quot;translate({x} {y})&quot;&gt;</span>
<span class="co">        &lt;circle r=&quot;5&quot; cx=&quot;8&quot; cy=&quot;8&quot; fill=&quot;{d.color}&quot;/&gt;</span>
<span class="co">        &lt;text class=&quot;legend&quot; x=&quot;16&quot; y=&quot;8&quot;&gt;{d.name}&lt;/text&gt;</span>
<span class="co">    &lt;/g&gt;</span>
<span class="co">    ***********************************************************************************/</span>
<span class="op">}</span>

<span class="va">redot</span>.<span class="at">applyTemplate</span>(<span class="st">&quot;#main&quot;</span><span class="op">,</span> PieChart<span class="op">,</span> data)<span class="op">;</span>        </code></pre></td></tr></table></div>
<script type="text/javascript" src="../../redot.js"></script>
<script type="text/javascript" id="theScript">
var data =     
{
    "date": "April 2016",
    "elements": [
        { "name": "Internet Explorer", value: 0.096, color: "#D95B43" },
        { "name": "Firefox", value: 0.097, color: "#C02942"  },
        { "name": "Google Chrome", value: 0.572, color: "#ECD078" },
        { "name": "Safari", value: 0.134, color: "#53777A" },
        { "name": "Opera", value: 0.041, color: "#542437" },
        { "name": "Other", value: 0.06, color: "#535353" }
    ]
};

// PieChart Template
function PieChart()
{
    this.width    = 400; // define width of client area
    this.height   = 400; // define height of client area
    this.radius   = "{width*0.30}";
    this.count    = "{d.elements.length}";

    /**********************************************************************************
    <div>
        <svg width="{width}" height="{height}" style="border: 1px black solid;">
            <text class="title" style="" x="{width/2}" y="40">
                {d.date}
            </text>
            <g transform="translate({width/2} {height/2})">
                <include template="{PieSlice}" data="{d.elements}" />
            </g>
            <g transform="translate(0 {height-16*count})">
                <include template="{Legend}" data="{d.elements}" />
            </g>
        </svg>
    </div>
    ********************************************************************************/
}

// PieSlice Template
function PieSlice()
{
    this.pieRange = redot.stack("{d.value}");

    /***********************************************************************************
    <path d="{redot.path.pieSlice(parent.radius,pieRange)}" stroke="black" fill="{d.color}"/>
    <text class="pietext" transform="{redot.centroid.pieSlice(parent.radius,pieRange)}">
        {redot.format.percent(d.value)}
    </text>
    ***********************************************************************************/
}

// Legend Template
function Legend()
{
    this.x = 5;
    this.y = "{i*16-5}";

    /***********************************************************************************
    <g transform="translate({x} {y})">
        <circle r="5" cx="8" cy="8" fill="{d.color}"/>
        <text class="legend" x="16" y="8">{d.name}</text>
    </g>
    ***********************************************************************************/
}

redot.applyTemplate("#main", PieChart, data);        

</script>
</div>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
		<script src="../js/bootstrap.min.js"></script>
		<script>
			var firstClick = true;
			function jsfiddle(title,description,extrajs)
			{
				var form = document.getElementById("fiddleForm");
				if(firstClick)
				{
					form.title.value = title;
					form.description.value = description;
					form.html.value = "<div id=\"main\"></div>";
					var script = document.getElementById("theScript");
					if(script)
					{
						form.js.value = script.textContent.trim();
					}

					var style = document.getElementById("theStyle");
					if(style)
					{
						form.css.value = style.textContent.trim();
					}
					if(extrajs)
					{
						firstClick = false;
						form.resources.value += extrajs;
					}
				}
				form.submit();
			}
		</script>
		<form id="fiddleForm" method="POST" action="http://jsfiddle.net/api/post/library/pure/" target="_bkank">
			<input type="hidden" name="html" value=""/>
			<input type="hidden" name="js" value=""/>
			<input type="hidden" name="css" value=""/>
			<input type="hidden" name="panel_html" value="0"/>
			<input type="hidden" name="panel_js" value="0"/>
			<input type="hidden" name="panel_css" value="0"/>
			<input type="hidden" name="resources" value="http://renato-mauro.github.io/redot/redot.js"/>
			<input type="hidden" name="title" value=""/>
			<input type="hidden" name="description" value=""/>
			<input type="hidden" name="normalize_css" value="no"/>
			<input type="hidden" name="dtd" value="html 4"/>
			<input type="hidden" name="wrap" value="b"/>
		</form>
</body>
</html>
