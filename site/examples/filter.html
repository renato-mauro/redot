<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>filter</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link href="../css/bootstrap.min.css" rel="stylesheet">
  <style type="text/css">
  td.lineNumbers {width:60px;}
  </style>
  <style id="theStyle">
  g.bar {
      transition: transform 1s ease;
  }
  
  g.bar text {
      font-family: sans-serif;
      font-size: 8pt;
      text-anchor: middle; 
  }
  </style>
</head>
<body>

		<nav class="navbar navbar-default">
		  <div class="container-fluid">
		    <div class="navbar-header">
		      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
		        <span class="sr-only">Toggle navigation</span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		      </button>
		      <a class="navbar-brand" href="http://renato-mauro.github.io/redot/">REDOT</a>
		    </div>
		    <div id="navbar" class="navbar-collapse collapse">
		      <ul class="nav navbar-nav">
		        <li><a href="https://github.com/renato-mauro/redot">Github</a></li>
		        <li><a href="#">Tutorial</a></li>
		        <li><a href="https://github.com/renato-mauro/redot/archive/master.zip">Download</a></li>
		        <li class="dropdown">
		          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Examples <span class="caret"></span></a>
		          <ul class="dropdown-menu">
	
<li><a href="http://renato-mauro.github.io/redot/site/examples/barchart1.html">BarChart1 Example</a></li>
<li><a href="http://renato-mauro.github.io/redot/site/examples/d3force1.html">D3 Force 1 Layout Example</a></li>
<li><a href="http://renato-mauro.github.io/redot/site/examples/filter.html">Filter Example</a></li>
<li><a href="http://renato-mauro.github.io/redot/site/examples/piechart1.html">PieChart1 Example</a></li>
<li><a href="http://renato-mauro.github.io/redot/site/examples/piegrid1.html">PieGrid1 Example</a></li>
<li><a href="http://renato-mauro.github.io/redot/site/examples/squares.html">Squares Example</a></li>

		          </ul>
		        </li>
		      </ul>
		    </div><!--/.nav-collapse -->
		  </div><!--/.container-fluid -->
		</nav>
<div class="container">
<h1 id="filter-example">Filter Example</h1>
<p>This example demonstrate reactive filter array, using three barcharts with shared objects.</p>
<button onclick="jsfiddle('Filter Example','This example demonstrate reactive filter array, using three barcharts with shared objects.','')">
Open in JSFiddle
</button>
<div id="main" style="margin:10px 0;">

</div>
<h2 id="css-filter.css">CSS (filter.css)</h2>
<div class="sourceCode"><table class="sourceCode css numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="sourceCode"><pre><code class="sourceCode css">g<span class="fl">.bar</span> <span class="kw">{</span>
    <span class="kw">transition:</span> transform <span class="dt">1s</span> ease<span class="kw">;</span>
<span class="kw">}</span>

g<span class="fl">.bar</span> text <span class="kw">{</span>
    <span class="kw">font-family:</span> <span class="dt">sans-serif</span><span class="kw">;</span>
    <span class="kw">font-size:</span> <span class="dt">8pt</span><span class="kw">;</span>
    <span class="kw">text-anchor:</span> <span class="dt">middle</span><span class="kw">;</span> 
<span class="kw">}</span></code></pre></td></tr></table></div>
<h2 id="javascript">Javascript</h2>
<div class="sourceCode"><table class="sourceCode javascript numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre></td><td class="sourceCode"><pre><code class="sourceCode javascript"><span class="kw">var</span> global <span class="op">=</span> <span class="op">{</span> <span class="dt">selectedItem</span><span class="op">:</span> <span class="kw">null</span> <span class="op">};</span>

<span class="kw">var</span> data <span class="op">=</span> []<span class="op">;</span>
<span class="cf">for</span>(<span class="kw">var</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span> i<span class="op">&lt;</span><span class="dv">50</span><span class="op">;</span> i<span class="op">++</span>)
<span class="op">{</span>
    <span class="va">data</span>.<span class="at">push</span>(<span class="op">{</span><span class="dt">qtd</span><span class="op">:~~</span>(<span class="va">Math</span>.<span class="at">random</span>()<span class="op">*</span><span class="dv">50</span>)<span class="op">+</span><span class="dv">10</span><span class="op">}</span>)<span class="op">;</span>
<span class="op">}</span>
<span class="kw">var</span> d1 <span class="op">=</span> <span class="va">redot</span>.<span class="at">filter</span>(data<span class="op">,</span><span class="st">&quot;{d.qtd&lt;30}&quot;</span>)<span class="op">;</span>
<span class="kw">var</span> d2 <span class="op">=</span> <span class="va">d1</span>.<span class="at">notSelected</span>()<span class="op">;</span>

<span class="at">setTimeout</span>(<span class="kw">function</span>()<span class="op">{</span><span class="va">data</span>.<span class="at">sort</span>(<span class="kw">function</span>(a<span class="op">,</span>b)<span class="op">{</span><span class="cf">return</span> <span class="va">a</span>.<span class="at">qtd</span><span class="op">-</span><span class="va">b</span>.<span class="at">qtd</span><span class="op">}</span>)<span class="op">;</span><span class="va">redot</span>.<span class="at">changed</span>(data)<span class="op">},</span><span class="dv">5000</span>)<span class="op">;</span>

<span class="kw">function</span> <span class="at">GraficoDeBarras</span>()
<span class="op">{</span>    
    <span class="kw">this</span>.<span class="at">width</span>    <span class="op">=</span> <span class="dv">1024</span><span class="op">;</span>
    <span class="kw">this</span>.<span class="at">height</span>   <span class="op">=</span> <span class="dv">150</span><span class="op">;</span>
    <span class="kw">this</span>.<span class="at">barWidth</span> <span class="op">=</span> <span class="st">&quot;{width/d.length}&quot;</span><span class="op">;</span>

    <span class="co">/*******************************************************</span>
<span class="co">    &lt;div&gt;</span>
<span class="co">        &lt;svg width=&quot;{width+30}&quot; height=&quot;{height+30}&quot;&gt;</span>
<span class="co">            &lt;g transform=&quot;translate(15,15)&quot;&gt;</span>
<span class="co">                &lt;include template=&quot;Barra&quot; data=&quot;{d}&quot; /&gt;</span>
<span class="co">            &lt;/g&gt;</span>
<span class="co">        &lt;/svg&gt;</span>
<span class="co">    &lt;/div&gt;</span>
<span class="co">    ********************************************************/</span>
<span class="op">}</span>

<span class="kw">function</span> <span class="at">Barra</span>()
<span class="op">{</span>
    <span class="kw">this</span>.<span class="at">maxQtd</span> <span class="op">=</span> <span class="va">redot</span>.<span class="va">agregate</span>.<span class="at">max</span>(<span class="st">&quot;{d.qtd}&quot;</span>)<span class="op">;</span>
    <span class="kw">this</span>.<span class="at">yScale</span> <span class="op">=</span> <span class="st">&quot;{parent.height/maxQtd}&quot;</span><span class="op">;</span>
    <span class="kw">this</span>.<span class="at">width</span>  <span class="op">=</span> <span class="st">&quot;{parent.barWidth}&quot;</span><span class="op">;</span>
    <span class="kw">this</span>.<span class="at">height</span> <span class="op">=</span> <span class="st">&quot;{yScale*d.qtd}&quot;</span><span class="op">;</span>
    <span class="kw">this</span>.<span class="at">x</span>      <span class="op">=</span> <span class="st">&quot;{i*width}&quot;</span><span class="op">;</span>
    <span class="kw">this</span>.<span class="at">y</span>      <span class="op">=</span> <span class="st">&quot;{parent.height-height}&quot;</span><span class="op">;</span>
    <span class="kw">this</span>.<span class="at">color</span>  <span class="op">=</span> <span class="st">&quot;{global.selectedItem == d ? &#39;blue&#39; : &#39;orange&#39;}&quot;</span>

    <span class="kw">this</span>.<span class="at">sel</span> <span class="op">=</span> <span class="kw">function</span>(d)
    <span class="op">{</span>
        <span class="va">global</span>.<span class="at">selectedItem</span> <span class="op">=</span> d<span class="op">;</span>
    <span class="op">}</span>
    
    <span class="co">/*::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span>
<span class="co">    &lt;g class=&quot;bar&quot; style=&quot;transform:translate({x}px,0);&quot;&gt;</span>
<span class="co">        &lt;rect onclick=&quot;{sel(d)}&quot; x=&quot;1&quot; y=&quot;{y}&quot; height=&quot;{height}&quot; width=&quot;{width-2}&quot; fill=&quot;{color}&quot;/&gt;</span>
<span class="co">        &lt;text x=&quot;{width/2}&quot; y=&quot;{y-6}&quot; dominant-baseline=&quot;middle&quot;&gt;{d.qtd}&lt;/text&gt; </span>
<span class="co">    &lt;/g&gt;</span>
<span class="co">    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::*/</span>
<span class="op">}</span>

<span class="va">redot</span>.<span class="at">applyTemplate</span>(<span class="st">&quot;#main&quot;</span><span class="op">,</span> GraficoDeBarras<span class="op">,</span> d1)<span class="op">;</span>
<span class="va">redot</span>.<span class="at">applyTemplate</span>(<span class="st">&quot;#main&quot;</span><span class="op">,</span> GraficoDeBarras<span class="op">,</span> d2)<span class="op">;</span>
<span class="va">redot</span>.<span class="at">applyTemplate</span>(<span class="st">&quot;#main&quot;</span><span class="op">,</span> GraficoDeBarras<span class="op">,</span> data)<span class="op">;</span></code></pre></td></tr></table></div>
<script type="text/javascript" src="../../redot.js"></script>
<script type="text/javascript" id="theScript">
var global = { selectedItem: null };

var data = [];
for(var i=0; i<50; i++)
{
    data.push({qtd:~~(Math.random()*50)+10});
}
var d1 = redot.filter(data,"{d.qtd<30}");
var d2 = d1.notSelected();

setTimeout(function(){data.sort(function(a,b){return a.qtd-b.qtd});redot.changed(data)},5000);

function GraficoDeBarras()
{    
    this.width    = 1024;
    this.height   = 150;
    this.barWidth = "{width/d.length}";

    /*******************************************************
    <div>
        <svg width="{width+30}" height="{height+30}">
            <g transform="translate(15,15)">
                <include template="Barra" data="{d}" />
            </g>
        </svg>
    </div>
    ********************************************************/
}

function Barra()
{
    this.maxQtd = redot.agregate.max("{d.qtd}");
    this.yScale = "{parent.height/maxQtd}";
    this.width  = "{parent.barWidth}";
    this.height = "{yScale*d.qtd}";
    this.x      = "{i*width}";
    this.y      = "{parent.height-height}";
    this.color  = "{global.selectedItem == d ? 'blue' : 'orange'}"

    this.sel = function(d)
    {
        global.selectedItem = d;
    }
    
    /*::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
    <g class="bar" style="transform:translate({x}px,0);">
        <rect onclick="{sel(d)}" x="1" y="{y}" height="{height}" width="{width-2}" fill="{color}"/>
        <text x="{width/2}" y="{y-6}" dominant-baseline="middle">{d.qtd}</text> 
    </g>
    ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::*/
}

redot.applyTemplate("#main", GraficoDeBarras, d1);
redot.applyTemplate("#main", GraficoDeBarras, d2);
redot.applyTemplate("#main", GraficoDeBarras, data);

</script>
</div>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
		<script src="../js/bootstrap.min.js"></script>
		<script>
			var firstClick = true;
			function jsfiddle(title,description,extrajs)
			{
				var form = document.getElementById("fiddleForm");
				if(firstClick)
				{
					form.title.value = title;
					form.description.value = description;
					form.html.value = "<div id=\"main\"></div>";
					var script = document.getElementById("theScript");
					if(script)
					{
						form.js.value = script.textContent.trim();
					}

					var style = document.getElementById("theStyle");
					if(style)
					{
						form.css.value = style.textContent.trim();
					}
					if(extrajs)
					{
						firstClick = false;
						form.resources.value += extrajs;
					}
				}
				form.submit();
			}
		</script>
		<form id="fiddleForm" method="POST" action="http://jsfiddle.net/api/post/library/pure/" target="_bkank">
			<input type="hidden" name="html" value=""/>
			<input type="hidden" name="js" value=""/>
			<input type="hidden" name="css" value=""/>
			<input type="hidden" name="panel_html" value="0"/>
			<input type="hidden" name="panel_js" value="0"/>
			<input type="hidden" name="panel_css" value="0"/>
			<input type="hidden" name="resources" value="http://renato-mauro.github.io/redot/redot.js"/>
			<input type="hidden" name="title" value=""/>
			<input type="hidden" name="description" value=""/>
			<input type="hidden" name="normalize_css" value="no"/>
			<input type="hidden" name="dtd" value="html 4"/>
			<input type="hidden" name="wrap" value="b"/>
		</form>
</body>
</html>
